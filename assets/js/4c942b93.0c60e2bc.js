"use strict";(self.webpackChunkresearch=self.webpackChunkresearch||[]).push([[1911],{5680:(e,a,t)=>{t.d(a,{xA:()=>p,yg:()=>u});var o=t(6540);function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){n(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,o,n=function(e,a){if(null==e)return{};var t,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}var l=o.createContext({}),c=function(e){var a=o.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):s(s({},a),e)),t},p=function(e){var a=c(e.components);return o.createElement(l.Provider,{value:a},e.children)},h="mdxType",m={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},d=o.forwardRef((function(e,a){var t=e.components,n=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),h=c(t),d=n,u=h["".concat(l,".").concat(d)]||h[d]||m[d]||r;return t?o.createElement(u,s(s({ref:a},p),{},{components:t})):o.createElement(u,s({ref:a},p))}));function u(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var r=t.length,s=new Array(r);s[0]=d;var i={};for(var l in a)hasOwnProperty.call(a,l)&&(i[l]=a[l]);i.originalType=e,i[h]="string"==typeof e?e:n,s[1]=i;for(var c=2;c<r;c++)s[c]=t[c];return o.createElement.apply(null,s)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},3124:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=t(8168),n=(t(6540),t(5680));const r={title:"Sassafras Part 1: A Novel Single Secret Leader Election Protocol"},s="Sassafras Part 1: A Novel Single Secret Leader Election Protocol",i={unversionedId:"Polkadot/protocols/block-production/Sassafras-Part-1",id:"Polkadot/protocols/block-production/Sassafras-Part-1",title:"Sassafras Part 1: A Novel Single Secret Leader Election Protocol",description:"Authors: Armando Caracheo, Elizabeth Crites, and Fatemeh Shirazi",source:"@site/docs/Polkadot/protocols/block-production/Sassafras-Part-1.md",sourceDirName:"Polkadot/protocols/block-production",slug:"/Polkadot/protocols/block-production/Sassafras-Part-1",permalink:"/Polkadot/protocols/block-production/Sassafras-Part-1",draft:!1,editUrl:"https://github.com/w3f/research/blob/master/docs/Polkadot/protocols/block-production/Sassafras-Part-1.md",tags:[],version:"current",frontMatter:{title:"Sassafras Part 1: A Novel Single Secret Leader Election Protocol"}},l={},c=[{value:"Randomized block production: the root of multiple producers and empty blocks",id:"randomized-block-production-the-root-of-multiple-producers-and-empty-blocks",level:2},{value:"Consistent timing from the core",id:"consistent-timing-from-the-core",level:2},{value:"Sassafras\u2019s innovative approach",id:"sassafrass-innovative-approach",level:2},{value:"An overview of how Sassafras works, step-by-step",id:"an-overview-of-how-sassafras-works-step-by-step",level:2},{value:"Eager to learn more about Sassafras?",id:"eager-to-learn-more-about-sassafras",level:2}],p={toc:c},h="wrapper";function m(e){let{components:a,...t}=e;return(0,n.yg)(h,(0,o.A)({},p,t,{components:a,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"sassafras-part-1-a-novel-single-secret-leader-election-protocol"},"Sassafras Part 1: A Novel Single Secret Leader Election Protocol"),(0,n.yg)("p",null,"Authors: Armando Caracheo, Elizabeth Crites, and Fatemeh Shirazi"),(0,n.yg)("p",null,"Polkadot is set to replace the ",(0,n.yg)("a",{parentName:"p",href:"https://wiki.polkadot.network/docs/learn-consensus#block-production-babe"},"BABE"),"+",(0,n.yg)("a",{parentName:"p",href:"https://openethereum.github.io/Aura.html"},"Aura")," consensus protocol with a new one: ",(0,n.yg)("em",{parentName:"p"},"Sassafras"),". Sassafras will be used to generate blocks on Polkadot's relay chain, but can be used in other proof-of-stake (PoS) blockchains as well. So, what key advantages does this new protocol bring to the blockchain ecosystem?"),(0,n.yg)("p",null,"Imagine a bread factory where loaves are produced at random time intervals and multiple conveyor belts may release bread simultaneously, but only one loaf can be packaged at once. Clearly, this is not the most efficient way to process as much bread as possible. In a way, what happens in this factory resembles the current state of block production in Polkadot, as well as in other PoS blockchains."),(0,n.yg)("p",null,"Classical proof-of-stake protocols for block generation create new blocks at unpredictable intervals, due to having multiple eligible block producers at once, or none at all. ",(0,n.yg)("a",{parentName:"p",href:"https://wiki.polkadot.network/docs/learn-consensus#block-production-babe"},"BABE")," similarly relies on randomized block generation and therefore inherits these traits."),(0,n.yg)("p",null,"Just like in the bread factory, where the system could benefit from fixed-time production and a single conveyor belt, allowing loaves to be packaged one after another, an optimized block generation mechanism should rely on constant-time intervals and a single block producer per block. These improvements increase the number of loaves that can be produced, and analogously the number of blocks added to the chain."),(0,n.yg)("p",null,"Production changes often introduce new challenges, and shifting to constant-time intervals within blockchain systems is no exception. Randomized block generation helps protect block producers from attacks, as adversaries are unable to predict the producer of the next block. For this reason, randomized block production has been considered a viable solution."),(0,n.yg)("p",null,"But what if a protocol could ensure secrecy of block producers, protecting them from a looming adversary, while realizing non-randomized block generation to improve efficiency? Centered on the concept of ",(0,n.yg)("em",{parentName:"p"},"single secret leader election")," (SSLE) (see ",(0,n.yg)("a",{parentName:"p",href:"https://hackmd.io/@W3F64sDIRkudVylsBHxi4Q/Bkr59i7ekg"},"Part 2"),"), the Sassafras block producer selection protocol achieves exactly that."),(0,n.yg)("p",null,"Curious to know how Sassafras works? Then keep reading."),(0,n.yg)("h2",{id:"randomized-block-production-the-root-of-multiple-producers-and-empty-blocks"},"Randomized block production: the root of multiple producers and empty blocks"),(0,n.yg)("p",null,"On Polkadot, ",(0,n.yg)("a",{parentName:"p",href:"https://wiki.polkadot.network/docs/learn-consensus#block-production-babe"},"BABE")," selects block producers through a process known as ",(0,n.yg)("em",{parentName:"p"},"probabilistic leader election")," (PLE), which is common in many modern PoS blockchains. Since leader selection is based on a randomized algorithm, the following outcomes may occur: multiple block producers may be eligible to add a block to the chain, or no block producer may be eligible when the block is expected."),(0,n.yg)("p",null,"Both outcomes have a negative impact on throughput (data processed per unit time), which is crucial to the scalability of blockchain consensus protocols. The absence of eligible block producers results in random time intervals between blocks. This can lead to a decrease in the overall throughput (i.e., fewer blocks in the final chain) and longer time intervals that lower the average block production rate."),(0,n.yg)("p",null,"One way to mitigate low throughput is to simply reduce the time between produced blocks. Such a reduction, however, introduces the likelihood of certain risks. For instance, block producers who generate new blocks without first seeing the previous one may create forks. "),(0,n.yg)("h2",{id:"consistent-timing-from-the-core"},"Consistent timing from the core"),(0,n.yg)("p",null,"Constant-time block generation helps eliminate these potential risks and can be achieved by assigning a single block producer whenever a new block is expected. For example, in a fixed block producer rotation using a round-robin style, each validator takes turns and generates a block in a predefined order. ",(0,n.yg)("a",{parentName:"p",href:"https://openethereum.github.io/Aura.html"},"Aura")," is a good example of this block production mechanism."),(0,n.yg)("p",null,"Unfortunately, this simple approach using a non-randomized algorithm for leader selection leaves the door open to attacks. If block producers are designated non-randomly and at fixed time intervals, the chain becomes vulnerable to forking and denial-of-service attacks."),(0,n.yg)("p",null,"One way to counter these vulnerabilities is to implement an SSLE protocol. In the literature, there are several proposed SSLE protocols for block producer elections (see ",(0,n.yg)("a",{parentName:"p",href:"https://hackmd.io/I8VSv8c6Rfizi9JWmzX25w"},"Part 3"),"). SSLE boasts many desirable features, which make it an attractive option for integration into PoS blockchains.  However, existing protocols have various drawbacks, particularly in terms of efficiency. Indeed, none have been deployed to date."),(0,n.yg)("h2",{id:"sassafrass-innovative-approach"},"Sassafras\u2019s innovative approach"),(0,n.yg)("p",null,"Sassafras is a consensus protocol designed to randomly select the next block producer. Its main aim is to efficiently select a unique block producer and release blocks at constant time intervals. To achieve definite finality of blocks, the protocol may be combined with another protocol, such as ",(0,n.yg)("a",{parentName:"p",href:"https://docs.polkadot.com/polkadot-protocol/architecture/polkadot-chain/pos-consensus/#"},"Grandpa"),"."),(0,n.yg)("p",null,"Sassafras operates as an SSLE protocol rather than a PLE protocol. Its novelty lies in using a ",(0,n.yg)("a",{parentName:"p",href:"https://eprint.iacr.org/2023/002"},"ring verifiable random function (VRF)")," to select a single block producer per block, while maintaining sufficient block producer secrecy within a \u201cring\u201d of all participants. This design reduces on-chain communication and computation, enhances block production as well as leader selection efficiency, and conceals the identities of a sufficient number of honest block producers (enough to stay secure) until the moment they create blocks."),(0,n.yg)("p",null,"We are now ready to describe the Sassafras protocol."),(0,n.yg)("h2",{id:"an-overview-of-how-sassafras-works-step-by-step"},"An overview of how Sassafras works, step-by-step"),(0,n.yg)("p",null,"At a high level, Sassafras works as follows. First, every validator generates a ticket, which they publish on-chain in a private manner. These tickets are sorted into a list. The first validator in that list reveals their identity and produces the next block. Tickets are kept private until the moment blocks are produced to protect validators from attacks."),(0,n.yg)("p",null,"In terms of timing, during an epoch of the blockchain, blocks are generated according to the election results of the previous epoch, and new leaders are elected for the next epoch."),(0,n.yg)("p",null,"The figure below illustrates the protocol in more detail. "),(0,n.yg)("p",null,(0,n.yg)("img",{parentName:"p",src:"https://hackmd.io/_uploads/BJaO6HF4ee.png",alt:"sassafrass-diagram"})),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Phase A)")," Each validator generates a ticket ",(0,n.yg)("span",{parentName:"p",className:"math math-inline"},(0,n.yg)("span",{parentName:"span",className:"katex"},(0,n.yg)("span",{parentName:"span",className:"katex-mathml"},(0,n.yg)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.yg)("semantics",{parentName:"math"},(0,n.yg)("mrow",{parentName:"semantics"},(0,n.yg)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.yg)("msub",{parentName:"mrow"},(0,n.yg)("mi",{parentName:"msub"},"y"),(0,n.yg)("mi",{parentName:"msub"},"i")),(0,n.yg)("mo",{parentName:"mrow",separator:"true"},","),(0,n.yg)("msub",{parentName:"mrow"},(0,n.yg)("mi",{parentName:"msub"},"\u03c3"),(0,n.yg)("mi",{parentName:"msub"},"i")),(0,n.yg)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,n.yg)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"(y_i, \\sigma_i)")))),(0,n.yg)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.yg)("span",{parentName:"span",className:"base"},(0,n.yg)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.yg)("span",{parentName:"span",className:"mopen"},"("),(0,n.yg)("span",{parentName:"span",className:"mord"},(0,n.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,n.yg)("span",{parentName:"span",className:"msupsub"},(0,n.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.yg)("span",{parentName:"span",className:"vlist-r"},(0,n.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3117em"}},(0,n.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},(0,n.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.yg)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,n.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.yg)("span",{parentName:"span",className:"vlist-r"},(0,n.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.yg)("span",{parentName:"span"})))))),(0,n.yg)("span",{parentName:"span",className:"mpunct"},","),(0,n.yg)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.yg)("span",{parentName:"span",className:"mord"},(0,n.yg)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"\u03c3"),(0,n.yg)("span",{parentName:"span",className:"msupsub"},(0,n.yg)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.yg)("span",{parentName:"span",className:"vlist-r"},(0,n.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.3117em"}},(0,n.yg)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"}},(0,n.yg)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.yg)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.yg)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,n.yg)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.yg)("span",{parentName:"span",className:"vlist-r"},(0,n.yg)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.yg)("span",{parentName:"span"})))))),(0,n.yg)("span",{parentName:"span",className:"mclose"},")")))))," consisting of the ring VRF outputs, and encrypts it using the encryption key of a randomly chosen validator. This validator, called a repeater, acts as an identity guard. Each validator then sends their ciphertext to all validators. Both the ticket and its repeater remain hidden."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Phase B)")," Each repeater receives all tickets and decrypts those for which it holds the decryption key. Repeaters then publish the tickets they have received on-chain."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Phase C)")," All tickets are sorted and recorded on-chain."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Phase D)")," When validator identities leak in Phase B, adversarial repeaters can decrypt their tickets (orange dots) and launch attacks (orange dots with a cross). The figure illustrates the worst-case scenario, in which all validators with leaked identities have been attacked. Even in this situation, the first honest validator on the sorted list (one who has not been attacked) is able to submit proof that they hold the winning ticket and become the next block producer."),(0,n.yg)("p",null,(0,n.yg)("strong",{parentName:"p"},"Phase E)")," The selected validator then generates the next block."),(0,n.yg)("p",null,"With these five phases in place, and since all block producers for an epoch are determined in the previous epoch, blocks can be generated seamlessly in constant time (e.g., every 6 seconds on Polkadot). Moreover, Sassafras achieves the highest efficiency among SSLE protocols while maintaining sufficient anonymity to ensure the security of a blockchain that deploys it. "),(0,n.yg)("p",null,"Striking this balance is what makes Sassafras an ideal candidate for real-world deployment. In fact, a specification of Sassafras, called Safrole, has already been integrated into the architecture of the upcoming ",(0,n.yg)("a",{parentName:"p",href:"https://graypaper.com/"},"JAM protocol"),".  "),(0,n.yg)("h2",{id:"eager-to-learn-more-about-sassafras"},"Eager to learn more about Sassafras?"),(0,n.yg)("p",null,"So far, we have presented a concise introduction to Sassafras, accessible to readers with a basic understanding of blockchains. We have also outlined the motivation behind the protocol and provided a clear overview of how it works. But this is only the beginning. The Web3 Foundation team has prepared two additional blog posts that explore Sassafras in greater detail."),(0,n.yg)("p",null,"Our next blog post, ",(0,n.yg)("a",{parentName:"p",href:"https://hackmd.io/@W3F64sDIRkudVylsBHxi4Q/Bkr59i7ekg"},"Part 2 - Deep Dive"),", will explain the concept of an SSLE protocol and delve into the technical details of Sassafras. The final chapter, ",(0,n.yg)("a",{parentName:"p",href:"https://hackmd.io/I8VSv8c6Rfizi9JWmzX25w"},"Part 3 - Compare and Convince"),", will demonstrate how Sassafras achieves unparalleled efficiency in block production and provide readers with a comparison of similar protocols, highlighting its value. The upcoming blog posts aim to describe how Sassafras offers a practical solution for achieving better throughput while maintaining security."),(0,n.yg)("p",null,"So stay tuned, brave reader. There's much more to discover in our upcoming Sassafras series, which is packed with valuable insights!"))}m.isMDXComponent=!0}}]);